/scratch_tmp/users/k23108295/pytorch-venv/bin/python3
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: jack-contro (jack-contro-king-s-college-london). Use `wandb login --relogin` to force relogin
wandb: Appending key for api.wandb.ai to your netrc file: /users/k23108295/.netrc
wandb: Tracking run with wandb version 0.19.1
wandb: Run data is saved locally in /users/k23108295/dataset-labelling-frontend/prediction_modelling/hpc_runner/wandb/run-20241220_143538-se3mclcf
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run training_run_20241220_143538
wandb: ‚≠êÔ∏è View project at https://wandb.ai/jack-contro-king-s-college-london/manipulation-detection
wandb: üöÄ View run at https://wandb.ai/jack-contro-king-s-college-london/manipulation-detection/runs/se3mclcf
2024-12-20 14:35:39,527 - INFO - Response processing results:
2024-12-20 14:35:39,527 - INFO - Response processing results:
2024-12-20 14:35:39,528 - INFO - Initial responses: 1935
2024-12-20 14:35:39,528 - INFO - Initial responses: 1935
2024-12-20 14:35:39,528 - INFO - Valid responses: 1679
2024-12-20 14:35:39,528 - INFO - Valid responses: 1679
2024-12-20 14:35:39,528 - INFO - Removed responses: 256
2024-12-20 14:35:39,528 - INFO - Removed responses: 256
2024-12-20 14:35:39,528 - INFO - Removal rate: 13.23%
2024-12-20 14:35:39,528 - INFO - Removal rate: 13.23%
2024-12-20 14:35:39,533 - INFO - Found 5 incomplete conversations
2024-12-20 14:35:39,533 - INFO - Found 5 incomplete conversations
2024-12-20 14:35:39,558 - INFO - Created merged DataFrame with shape: (746, 24)
2024-12-20 14:35:39,558 - INFO - Created merged DataFrame with shape: (746, 24)
2024-12-20 14:35:39,566 - WARNING - Found 9 empty lists in column peer pressure
2024-12-20 14:35:39,566 - WARNING - Found 9 empty lists in column peer pressure
2024-12-20 14:35:39,574 - WARNING - Found 5 empty lists in column reciprocity pressure
2024-12-20 14:35:39,574 - WARNING - Found 5 empty lists in column reciprocity pressure
2024-12-20 14:35:39,580 - WARNING - Found 3 empty lists in column gaslighting
2024-12-20 14:35:39,580 - WARNING - Found 3 empty lists in column gaslighting
2024-12-20 14:35:39,587 - WARNING - Found 7 empty lists in column guilt-tripping
2024-12-20 14:35:39,587 - WARNING - Found 7 empty lists in column guilt-tripping
2024-12-20 14:35:39,595 - WARNING - Found 8 empty lists in column emotional blackmail
2024-12-20 14:35:39,595 - WARNING - Found 8 empty lists in column emotional blackmail
2024-12-20 14:35:39,609 - WARNING - Found 4 empty lists in column fear enhancement
2024-12-20 14:35:39,609 - WARNING - Found 4 empty lists in column fear enhancement
2024-12-20 14:35:39,616 - WARNING - Found 4 empty lists in column negging
2024-12-20 14:35:39,616 - WARNING - Found 4 empty lists in column negging
Some weights of LlamaForSequenceClassification were not initialized from the model checkpoint at meta-llama/Llama-3.2-1B and are newly initialized: ['score.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
/scratch_tmp/users/k23108295/pytorch-venv/lib/python3.10/site-packages/transformers/training_args.py:1575: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ü§ó Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-12-20 14:35:42,678 - INFO - Starting training...
wandb: WARNING The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
Successfully logged into Weights & Biases!

Stratification column distributions:

Column: manipulation_type
Training set distribution:
manipulation_type
Fear Enhancement        0.161826
Negging                 0.153527
Peer Pressure           0.141079
Guilt-Tripping          0.141079
Reciprocity Pressure    0.141079
Gaslighting             0.132780
Emotional Blackmail     0.128631
Name: proportion, dtype: float64

Test set distribution:
manipulation_type
Fear Enhancement        0.1625
Negging                 0.1500
Gaslighting             0.1375
Guilt-Tripping          0.1375
Reciprocity Pressure    0.1375
Peer Pressure           0.1375
Emotional Blackmail     0.1375
Name: proportion, dtype: float64

Column: persuasion_strength
Training set distribution:
persuasion_strength
helpful    0.509317
strong     0.490683
Name: proportion, dtype: float64

Test set distribution:
persuasion_strength
helpful    0.5
strong     0.5
Name: proportion, dtype: float64

Additional target column distributions:

Column: peer pressure_binary
Training set distribution:
peer pressure_binary
0    0.651741
1    0.348259
Name: proportion, dtype: float64

Test set distribution:
peer pressure_binary
0    0.664179
1    0.335821
Name: proportion, dtype: float64

Column: reciprocity pressure_binary
Training set distribution:
reciprocity pressure_binary
0    0.691542
1    0.308458
Name: proportion, dtype: float64

Test set distribution:
reciprocity pressure_binary
0    0.753731
1    0.246269
Name: proportion, dtype: float64

Column: gaslighting_binary
Training set distribution:
gaslighting_binary
1    0.512438
0    0.487562
Name: proportion, dtype: float64

Test set distribution:
gaslighting_binary
1    0.589552
0    0.410448
Name: proportion, dtype: float64

Column: guilt-tripping_binary
Training set distribution:
guilt-tripping_binary
0    0.549751
1    0.450249
Name: proportion, dtype: float64

Test set distribution:
guilt-tripping_binary
0    0.537313
1    0.462687
Name: proportion, dtype: float64

Column: emotional blackmail_binary
Training set distribution:
emotional blackmail_binary
0    0.676617
1    0.323383
Name: proportion, dtype: float64

Test set distribution:
emotional blackmail_binary
0    0.708955
1    0.291045
Name: proportion, dtype: float64

Column: general_binary
Training set distribution:
general_binary
1    0.579602
0    0.420398
Name: proportion, dtype: float64

Test set distribution:
general_binary
1    0.641791
0    0.358209
Name: proportion, dtype: float64

Column: fear enhancement_binary
Training set distribution:
fear enhancement_binary
0    0.517413
1    0.482587
Name: proportion, dtype: float64

Test set distribution:
fear enhancement_binary
0    0.507463
1    0.492537
Name: proportion, dtype: float64

Column: negging_binary
Training set distribution:
negging_binary
0    0.579602
1    0.420398
Name: proportion, dtype: float64

Test set distribution:
negging_binary
0    0.604478
1    0.395522
Name: proportion, dtype: float64
Using device: cpu
  0%|          | 0/600 [00:00<?, ?it/s]slurmstepd: error: *** JOB 22535030 ON erc-hpc-comp006 CANCELLED AT 2024-12-20T14:37:17 ***
